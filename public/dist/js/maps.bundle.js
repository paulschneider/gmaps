!function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return e[i].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var r=n(1),o=i(r),a=n(5);if(document.getElementById("map")){var l=new o.default(a.Setup);l.build();var s=document.getElementsByClassName("show-hide");Array.from(s).forEach(function(e){e.addEventListener("click",function(e){l.showMarker(e.target.dataset.hospitalId)},l)}),document.getElementById("age-filter").addEventListener("change",function(e){l.filterByAge(e.target.value)},l),document.getElementById("service-type-filter").addEventListener("change",function(e){l.filterByType(e.target.value)},l)}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(2),s=i(l),u=n(3),c=i(u),f=n(4),d=function(){function e(t){r(this,e),this.config=t,this.services=f.Services,this.kmlLayer=null,this.markers=[],this.map=null,s.default.KEY=this.config.apiKey,this.ages={},this.serviceTypes={},this.filters=[]}return a(e,[{key:"build",value:function(){var e=this;s.default.load(function(t){e.map=new t.maps.Map(document.querySelector(e.config.selector),{center:new t.maps.LatLng(e.config.centreLat,e.config.centreLang),zoom:e.config.startZoom,mapTypeId:e.config.mapType}),e.loadKml(e.config.kml.start),e.addMarkers(!0),e.compileAges(),e.compileServiceTypes()})}},{key:"loadKml",value:function(e){var t=this;s.default.load(function(n){t.kmlLayer=new n.maps.KmlLayer({url:e}),t.kmlLayer.setMap(t.map)})}},{key:"addMarkers",value:function(e){var t=this;this.services.forEach(function(n){var i=new c.default(n);t.markers.push(i),e&&t.showMarker(i.id)})}},{key:"showMarker",value:function(e){var t=this;this.markers.forEach(function(n){n.id===parseInt(e)&&n.pin.setMap(n.setVisibility(t.map))},e)}},{key:"compileAges",value:function(){var e=this;this.markers.forEach(function(t){for(var n in t.ages)n=t.ages[n],e.ages[n]||(e.ages[n]=[]),e.ages[n].push(t)})}},{key:"compileServiceTypes",value:function(){var e=this;this.markers.forEach(function(t){for(var n in t.services){var i=t.services[n];e.serviceTypes[i]||(e.serviceTypes[i]=[]),e.serviceTypes[i].push(t)}})}},{key:"filterByAge",value:function(e){this.addFilter("ageFilter",e).apply()}},{key:"filterByType",value:function(e){this.addFilter("typeFilter",e).apply()}},{key:"apply",value:function(){var e=this;console.log(JSON.stringify(this.filters)),this.filters.forEach(function(t){e[t.method](t.value)})}},{key:"ageFilter",value:function(e){var t=this;this.showAllMarkers(),new Promise(function(e,n){e(t.getActiveMarkers())}).then(function(n){if(!e)return t.showAllMarkers();var i=function(i){if(i===e){var r=n.filter(function(e){return t.ages[i].includes(e)});return{v:t.showMarkers(r)}}};for(var r in t.ages){var a=i(r);if("object"===("undefined"==typeof a?"undefined":o(a)))return a.v}})}},{key:"typeFilter",value:function(e){var t=this;new Promise(function(e,n){e(t.getActiveMarkers())}).then(function(n){if(!e)return t.showAllMarkers();var i=function(i){if(i===e){var r=n.filter(function(e){return t.serviceTypes[i].includes(e)});return{v:t.showMarkers(r)}}};for(var r in t.serviceTypes){var a=i(r);if("object"===("undefined"==typeof a?"undefined":o(a)))return a.v}})}},{key:"showMarkers",value:function(e){var t=this;this.hideAllMarkers(),e.forEach(function(e){t.showMarker(e.id)})}},{key:"showAllMarkers",value:function(){var e=this;this.markers.forEach(function(t){t.pin.setMap(e.map),t.show()})}},{key:"hideAllMarkers",value:function(){this.markers.forEach(function(e){e.pin.setMap(null),e.hide()})}},{key:"addFilter",value:function(e,t){return this.applyFilter(e,t),this}},{key:"applyFilter",value:function(e,t){for(var n in this.filters)if(this.filters[n].method===e)return this.filters[n].value=t;return this.filters.push({method:e,value:t})}},{key:"getActiveMarkers",value:function(){var e=[];return this.markers.forEach(function(t){t.isHidden()||e.push(t)}),e}}]),e}();t.default=d},function(e,t,n){var i,r;!function(o,a){if(null===o)throw new Error("Google-maps package can be used only in browser");i=a,r="function"==typeof i?i.call(t,n,t,e):i,!(void 0!==r&&(e.exports=r))}("undefined"!=typeof window?window:null,function(){"use strict";var e="3.18",t=null,n=null,i=!1,r=[],o=[],a=null,l={};l.URL="https://maps.googleapis.com/maps/api/js",l.KEY=null,l.LIBRARIES=[],l.CLIENT=null,l.CHANNEL=null,l.LANGUAGE=null,l.REGION=null,l.VERSION=e,l.WINDOW_CALLBACK_NAME="__google_maps_api_provider_initializator__",l._googleMockApiObject={},l.load=function(e){null===n?i===!0?e&&r.push(e):(i=!0,window[l.WINDOW_CALLBACK_NAME]=function(){s(e)},l.createLoader()):e&&e(n)},l.createLoader=function(){t=document.createElement("script"),t.type="text/javascript",t.src=l.createUrl(),document.body.appendChild(t)},l.isLoaded=function(){return null!==n},l.createUrl=function(){var e=l.URL;return e+="?callback="+l.WINDOW_CALLBACK_NAME,l.KEY&&(e+="&key="+l.KEY),l.LIBRARIES.length>0&&(e+="&libraries="+l.LIBRARIES.join(",")),l.CLIENT&&(e+="&client="+l.CLIENT+"&v="+l.VERSION),l.CHANNEL&&(e+="&channel="+l.CHANNEL),l.LANGUAGE&&(e+="&language="+l.LANGUAGE),l.REGION&&(e+="&region="+l.REGION),e},l.release=function(s){var u=function(){l.KEY=null,l.LIBRARIES=[],l.CLIENT=null,l.CHANNEL=null,l.LANGUAGE=null,l.REGION=null,l.VERSION=e,n=null,i=!1,r=[],o=[],"undefined"!=typeof window.google&&delete window.google,"undefined"!=typeof window[l.WINDOW_CALLBACK_NAME]&&delete window[l.WINDOW_CALLBACK_NAME],null!==a&&(l.createLoader=a,a=null),null!==t&&(t.parentElement.removeChild(t),t=null),s&&s()};i?l.load(function(){u()}):u()},l.onLoad=function(e){o.push(e)},l.makeMock=function(){a=l.createLoader,l.createLoader=function(){window.google=l._googleMockApiObject,window[l.WINDOW_CALLBACK_NAME]()}};var s=function(e){var t;for(i=!1,null===n&&(n=window.google),t=0;t<o.length;t++)o[t](n);for(e&&e(n),t=0;t<r.length;t++)r[t](n);r=[]};return l})},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(2),l=i(a),s=function(){function e(t){var n=this;return r(this,e),this.pin=null,this.id=t.id,this.hidden=!0,this.ages=t.ages,this.services=t.services,l.default.load(function(e){n.pin=new e.maps.Marker({position:{lat:t.location.lat,lng:t.location.lng}})}),this}return o(e,[{key:"setVisibility",value:function(e){return this.hidden?(this.hidden=!1,e):(this.hidden=!0,null)}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return console.log("IS HIDDEN",this.hidden),this.hidden}}]),e}();t.default=s},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Services=Object.freeze([{id:1,location:{lat:-37.6527073,lng:145.0120898},ages:["youth","adult"],services:["inpatient-unit","residential","community-care","community-team"]},{id:2,location:{lat:-37.7987306,lng:144.9541191},ages:["youth"],services:["prevention-recovery","inpatient-unit","general-admin-queries","emergency-mental-health"]},{id:3,location:{lat:-37.88719,lng:144.6965135},ages:["senior"],services:["community-team","specialist-service"]}])},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Setup=Object.freeze({apiKey:"AIzaSyCbDyxAp1SlhHAfVJGH3F1m4ZX43tQhXj4",selector:"#map",centreLat:-37.8055124,centreLang:144.9746755,startZoom:14,mapType:"roadmap",kml:{start:"https://raw.githubusercontent.com/paulschneider/kml-test/master/source-4.kml?123132654",replacement:"https://raw.githubusercontent.com/paulschneider/kml-test/master/source-5.kml?123132654"}})}]);